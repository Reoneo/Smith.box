<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ENS Avatar Fetcher</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 2rem auto; }
        .container { padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        .avatar { max-width: 200px; margin-top: 20px; }
        .method { margin-bottom: 2rem; }
    </style>
</head>
<body>
    <h1>ENS Avatar Fetcher</h1>

    <!-- Method 1: Using Wagmi -->
    <div class="method">
        <h2>Method 1: Using Wagmi + Viem</h2>
        <div class="container">
            <input type="text" id="ensInput1" placeholder="Enter ENS name (e.g., vitalik.eth)">
            <button onclick="fetchWithWagmi()">Fetch Avatar</button>
            <div id="avatarContainer1"></div>
        </div>
    </div>

    <!-- Method 2: Using ENSJS-v3 -->
    <div class="method">
        <h2>Method 2: Using ENSJS-v3</h2>
        <div class="container">
            <input type="text" id="ensInput2" placeholder="Enter ENS name (e.g., vitalik.eth)">
            <button onclick="fetchWithENSJS()">Fetch Avatar</button>
            <div id="avatarContainer2"></div>
        </div>
    </div>

    <!-- Required Libraries -->
    <!-- Wagmi + Viem -->
    <script src="https://cdn.jsdelivr.net/npm/viem@1.0.0/dist/viem.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/wagmi@1.0.0/dist/wagmi.js"></script>
    
    <!-- ENSJS-v3 -->
    <script src="https://cdn.jsdelivr.net/npm/@ensdomains/ensjs@3.0.0/dist/ensjs.umd.min.js"></script>

    <script>
        // ========== Method 1: Wagmi Implementation ==========
        async function fetchWithWagmi() {
            const ensName = document.getElementById('ensInput1').value;
            const container = document.getElementById('avatarContainer1');
            container.innerHTML = 'Loading...';

            try {
                const client = wagmi.createClient({
                    transport: viem.http('https://mainnet.infura.io/v3/YOUR_INFURA_KEY')
                });

                const avatar = await wagmi.fetchEnsAvatar(client, {
                    name: ensName,
                    chainId: 1
                });

                if (avatar) {
                    container.innerHTML = `<img src="${avatar}" class="avatar" alt="ENS Avatar">`;
                } else {
                    container.innerHTML = 'No avatar found for this ENS name';
                }
            } catch (error) {
                container.innerHTML = `Error: ${error.message}`;
            }
        }

        // ========== Method 2: ENSJS-v3 Implementation ==========
        async function fetchWithENSJS() {
            const ensName = document.getElementById('ensInput2').value;
            const container = document.getElementById('avatarContainer2');
            container.innerHTML = 'Loading...';

            try {
                const transport = viem.http('https://mainnet.infura.io/v3/YOUR_INFURA_KEY');
                const ens = new ENSJS.ENS({ transport, chainId: 1 });
                
                const { url } = await ens.getAvatar(ensName);
                
                if (url) {
                    container.innerHTML = `<img src="${url}" class="avatar" alt="ENS Avatar">`;
                } else {
                    container.innerHTML = 'No avatar found for this ENS name';
                }
            } catch (error) {
                container.innerHTML = `Error: ${error.message}`;
            }
        }
    </script>

    <!-- Notes -->
    <div style="margin-top: 2rem; color: #666;">
        <h3>Important Notes:</h3>
        <ul>
            <li>Replace YOUR_INFURA_KEY with your actual Infura project ID</li>
            <li>Make sure the ENS name has an avatar set in its resolver</li>
            <li>For offchain avatars (CCIP Read), ensure your provider supports ERC-3668</li>
            <li>You might need to handle CORS issues in production (consider using a proxy)</li>
        </ul>
    </div>
</body>
</html>